<!DOCTYPE html>
<html lang="en" data-theme="system">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Vibe IDE ‚Äî Cloud Manifestor</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;600&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/lib/codemirror.css">
<script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/lib/codemirror.js"></script>
<script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/htmlmixed/htmlmixed.js"></script>
<script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/xml/xml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/javascript/javascript.js"></script>
<script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/css/css.js"></script>
<style>
:root{--bg:#0b0d14;--fg:#e6e6f0;--accent:#7c9cff;--accent2:#5ef0ff}
[data-theme=light]{--bg:#fff;--fg:#0e1220}
html,body{height:100%;margin:0}body{background:var(--bg);color:var(--fg);font-family:"IBM Plex Sans",system-ui;overflow:hidden}
#banner{position:fixed;top:0;left:0;right:0;background:rgba(20,24,36,.9);color:#eaf2ff;display:flex;gap:.75rem;align-items:center;padding:.6rem .9rem;border-bottom:1px solid rgba(124,156,255,.25);z-index:40}
#banner .pill{background:rgba(124,156,255,.15);padding:.25rem .6rem;border-radius:9999px;font-size:.8rem}
#banner .actions{margin-left:auto;display:flex;gap:.5rem}
.btn,.sbtn{border:none;cursor:pointer;border-radius:9999px;font-weight:700}
.btn{padding:.55rem 1rem;background:linear-gradient(135deg,var(--accent),var(--accent2));color:#fff}
.btn:disabled{opacity:.5;cursor:not-allowed}.sbtn{padding:.35rem .7rem;background:transparent;color:var(--accent);border:1px solid rgba(124,156,255,.35)}
#card{position:fixed;inset:72px 18px 18px 18px;border:1px solid rgba(124,156,255,.18);border-radius:16px;background:rgba(15,18,30,.72);box-shadow:0 10px 40px rgba(0,0,0,.35);display:grid;grid-template-rows:auto 1fr auto}
#titlebar{display:flex;align-items:center;gap:.6rem;padding:.7rem 1rem;border-bottom:1px solid rgba(124,156,255,.18);font-weight:600}
.CodeMirror{height:100%;font-family:"IBM Plex Mono",monospace;font-size:.95rem}
#footer{display:flex;gap:.5rem;justify-content:flex-end;padding:.6rem .9rem;border-top:1px solid rgba(124,156,255,.18)}
#toast{position:fixed;bottom:18px;left:50%;transform:translateX(-50%);background:#222;color:#fff;padding:.6rem .9rem;border-radius:10px;opacity:0;pointer-events:none;transition:opacity .25s;z-index:50}
#toast.show{opacity:1}#overlay{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center;z-index:45}
#overlay.active{display:flex}#overlay .box{background:#0e1220;color:#e6e6f0;padding:1rem 1.2rem;border-radius:12px;border:1px solid rgba(124,156,255,.25)}
#confetti{position:fixed;inset:0;pointer-events:none;z-index:60}#badge{position:fixed;right:12px;bottom:12px;font-size:.8rem;color:#9aa3b2;background:rgba(15,18,30,.6);padding:.35rem .6rem;border-radius:8px;border:1px solid rgba(124,156,255,.2);text-decoration:none}
</style>
</head>
<body>
<div id="banner"><span>üåê <strong>Your vibe is live</strong></span><span id="vibeId" class="pill">vibe-xxxxx</span><span id="status" class="pill">checking‚Ä¶</span>
<div class="actions"><button id="copyLink" class="sbtn">üìã Copy link</button><button id="remixBtn" class="sbtn">üé® Remix</button><button id="revertBtn" class="sbtn">üí´ Revert</button><button id="dismiss" class="sbtn">Dismiss ‚ú®</button></div></div>
<section id="card" aria-label="Vibe IDE"><div id="titlebar">/vibe-code.html</div><div id="editor"></div>
<div id="footer"><button id="saveBtn" class="sbtn">Save File ‚§ì</button><button id="copyBtn" class="sbtn">Copy Code ‚ùê</button><button id="manifestBtn" class="btn">Manifest ‚ú® (Push)</button><button id="proUpdateBtn" class="sbtn">Pro Update (Project)</button></div></section>
<div id="overlay"><div class="box">‚ú® Manifesting your vibe‚Ä¶</div></div><canvas id="confetti"></canvas>
<a id="badge" href="https://www.ibm.com/architectures/deployable-architectures" target="_blank" rel="noopener">Powered by IBM Cloud üåÄ</a>
<script>
window.__VIBE_CONFIG__ = {
  UPLOAD_ENDPOINT: "%%UPLOAD_ENDPOINT%%",
  STATUS_ENDPOINT: "%%STATUS_ENDPOINT%%",
  PROJECT_UPDATE_ENDPOINT: "%%PROJECT_UPDATE_ENDPOINT%%",
  BUCKET_PUBLIC_URL: "%%BUCKET_PUBLIC_URL%%",
  VIBE_ID: "%%VIBE_ID%%"
};
(function(){const mq=matchMedia('(prefers-color-scheme: light)');document.documentElement.setAttribute('data-theme', mq.matches?'light':'dark');mq.addEventListener('change', e=>document.documentElement.setAttribute('data-theme', e.matches?'light':'dark'));})();
const banner=document.getElementById('banner'),statusEl=document.getElementById('status'),vibeIdEl=document.getElementById('vibeId'),copyLinkBtn=document.getElementById('copyLink'),remixBtn=document.getElementById('remixBtn'),revertBtn=document.getElementById('revertBtn'),dismissBtn=document.getElementById('dismiss'),overlay=document.getElementById('overlay');
const toast=document.getElementById('toast')||(function(){const t=document.createElement('div');t.id='toast';document.body.appendChild(t);return t;})();
const confettiCanvas=document.getElementById('confetti'),ctx=confettiCanvas.getContext('2d');
const cm=CodeMirror(document.getElementById('editor'),{value:`<!-- Paste/edit your vibe HTML here. Click "Manifest ‚ú®" to publish. -->
<h1 style="text-align:center">Vibe IDE ‚Äî Hello, Cloud! üåà</h1>
<p style="text-align:center">Edit me and press <strong>Manifest ‚ú®</strong> to push to IBM Cloud Object Storage.</p>
`,mode:"htmlmixed",lineNumbers:true,tabSize:2});
(async function preload(){const u=new URL(location.href);if(u.searchParams.has('src')){try{const s=u.searchParams.get('src');const d=decodeURIComponent(atob(s));cm.setValue(d);msg('Loaded remix source ‚ú®');}catch(e){}}})();
vibeIdEl.textContent=window.__VIBE_CONFIG__.VIBE_ID||"vibe-local";
function msg(m){toast.textContent=m;toast.classList.add('show');setTimeout(()=>toast.classList.remove('show'),1800);}
dismissBtn.onclick=()=>banner.style.display='none';
copyLinkBtn.onclick=async()=>{const url=(window.__VIBE_CONFIG__.BUCKET_PUBLIC_URL||location.origin)+'/index.html';await navigator.clipboard.writeText(url);msg('‚ú® Copied your vibe link!');};
remixBtn.onclick=()=>{const code=btoa(encodeURIComponent(cm.getValue()));const link=location.origin+location.pathname+'?src='+code;navigator.clipboard.writeText(link).then(()=>msg('üé® Remix link copied!'));};
revertBtn.onclick=async()=>{if(!window.__VIBE_CONFIG__.UPLOAD_ENDPOINT)return msg('Missing upload endpoint');overlay.classList.add('active');try{const r=await fetch(window.__VIBE_CONFIG__.UPLOAD_ENDPOINT,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({action:'rollback'})});const j=await r.json();if(j.ok){confetti();msg('üí´ Reverted to previous vibe');}else{msg('Rollback failed: '+(j.error||'unknown'));}}catch(e){msg('Rollback error');}finally{overlay.classList.remove('active');}};
document.getElementById('copyBtn').onclick=async()=>{await navigator.clipboard.writeText(cm.getValue());msg('Copied code ‚ùê');};
document.getElementById('saveBtn').onclick=()=>{const a=document.createElement('a');const b=new Blob([cm.getValue()],{type:'text/html'});a.href=URL.createObjectURL(b);a.download='vibe-code.html';a.click();};
document.getElementById('manifestBtn').onclick=async()=>{if(!window.__VIBE_CONFIG__.UPLOAD_ENDPOINT)return msg('Missing upload endpoint');overlay.classList.add('active');try{const r=await fetch(window.__VIBE_CONFIG__.UPLOAD_ENDPOINT,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({action:'upload',key:'index.html',content_b64:btoa(unescape(encodeURIComponent(cm.getValue())))})});const j=await r.json();if(j.ok){confetti();msg('üöÄ Deployed to COS');}else{msg('Deploy failed: '+(j.error||'unknown'));}}catch(e){msg('Deploy error');}finally{overlay.classList.remove('active');}};
document.getElementById('proUpdateBtn').onclick=async()=>{if(!window.__VIBE_CONFIG__.PROJECT_UPDATE_ENDPOINT)return msg('Missing project update endpoint');overlay.classList.add('active');try{const r=await fetch(window.__VIBE_CONFIG__.PROJECT_UPDATE_ENDPOINT,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({intent:'request_update',note:'User requested config update to match live code.'})});const j=await r.json();if(j.ok){msg('üìù Update request recorded');}else{msg('Update request failed: '+(j.error||'unknown'));}}catch(e){msg('Update error');}finally{overlay.classList.remove('active');}};
(async function status(){try{statusEl.textContent='checking‚Ä¶';if(!window.__VIBE_CONFIG__.STATUS_ENDPOINT){statusEl.textContent='no-status';return;}const r=await fetch(window.__VIBE_CONFIG__.STATUS_ENDPOINT);const j=await r.json();statusEl.textContent=(j.status==='success')?'‚úÖ ready':'‚ö†Ô∏è '+(j.status||'unknown');}catch(e){statusEl.textContent='‚ö†Ô∏è error';}})();
function confetti(){const W=confettiCanvas.width=innerWidth,H=confettiCanvas.height=innerHeight;const pcs=Array.from({length:120},()=>({x:Math.random()*W,y:-20-Math.random()*H*.5,r:2+Math.random()*4,vy:2+Math.random()*3,vx:-2+Math.random()*4,a:Math.random()*Math.PI*2}));let t=0;function step(){ctx.clearRect(0,0,W,H);t++;for(const p of pcs){p.x+=p.vx;p.y+=p.vy;p.a+=.1;const s=Math.abs(Math.sin(p.a))*.6+.4;ctx.fillStyle=`hsl(${(p.x/4+p.y/3)%360},90%,${60+20*s}%)`;ctx.beginPath();ctx.arc(p.x,p.y,p.r*s,0,Math.PI*2);ctx.fill();}if(t<180)requestAnimationFrame(step);else ctx.clearRect(0,0,W,H);}step();}
</script>
<!-- Builds on static website DA concepts by Arn Hyndman (colleague). -->
</body></html>
