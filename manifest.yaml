# IBM Cloud Deployable Architecture Manifest
schema_version: "1.0"

name: vibe-da-ibm-cloud
version: 1.2.0
type: terraform

# Friendly metadata
display_name: "üåÄ Vibe Landing Zone ‚Äî IBM Cloud Edition"
description: >
  Deploy a fully hosted, instantly remixable ‚ÄúVibe Landing Zone‚Äù on IBM Cloud.
  This architecture provisions an Object Storage (Lite) bucket, uploads a live
  HTML sample app, and optionally enables IBM Cloud Code Engine for easy updates
  to COS and staging/triggering changes in IBM Cloud Projects via the web UI.

# Entry points
variables:
  - name: region
    type: string
    description: "IBM Cloud region (e.g., us-south). Usually inferred from Project."
    default: "us-south"

  - name: project_id
    type: string
    description: "(Optional) Project ID. Auto-detected when deployed via IBM Cloud Projects. Required otherwise."
    required: false

  - name: resource_group_id
    type: string
    description: "(Optional) Resource Group ID. Auto-detected when deployed via IBM Cloud Projects. Required otherwise."
    required: false

  - name: config_id
    type: string
    description: |-
      (Required) The Configuration ID from the Project URL or CLI.
      Example URL: .../projects/{project_id}/configurations/{config_id}
      Example CLI: ibmcloud project config-get --project-id {pid} --id {cid}
    required: true

  - name: enable_code_engine
    type: bool
    description: "Enable IBM Cloud Code Engine functions for COS/Project interaction."
    default: true

  - name: website_index
    type: string
    description: "Name of the index file for the COS website."
    default: "index.html"

  - name: website_error
    type: string
    description: "Name of the error file for the COS website."
    default: "404.html"

  # auto_deploy_project_changes variable removed

outputs:
  - name: primaryoutputlink
    type: string
    description: "Primary link to your deployed Vibe website."
    required: true # Output itself is always required/generated
    is_primary: true # Mark as the main output
    usage_hint: "Open your deployed site in a new tab to feel the vibe."

  - name: vibe_bucket_name
    type: string
    description: "COS bucket name created for your deployment."

  - name: vibe_bucket_crn
    type: string
    description: "COS bucket CRN for reference and governance."

  - name: push_cos_url # Exposing function URLs might be useful for debugging/integration
    type: string
    description: "URL for the 'Push to COS' function."
    required: false # Only generated if code engine is enabled

  - name: push_project_url # Staging function
    type: string
    description: "URL for the 'Push to Project' (staging) function."
    required: false

  - name: trigger_deploy_url # Trigger function
    type: string
    description: "URL for the 'Trigger Project Deploy' function."
    required: false